<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add User</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body {
    background: #f8f9fa;
    font-family: Arial, sans-serif;
}

/* SIDEBAR ------------------------------------------------*/
.sidebar {
    position: fixed;
    width: 220px;
    height: 100vh;
    background: #4b4f53ff;
    color: white;
    padding-top: 20px;
    top: 0;
    left: 0;
    z-index: 1100;
}

.sidebar a {
    color: white;
    display: block;
    padding: 10px 20px;
    text-decoration: none;
}
.sidebar a:hover { background: #495057; }
.sidebar a.active {
    background: #6c757d;
    font-weight: bold;
    border-left: 4px solid #ffc107;
}

.sidebar-logo {
    max-width: 120px;
    border-radius: 50%;
    padding: 5px;
    background: #343a40;
}

/* MAIN CONTENT -------------------------------------------*/
.main-content {
    margin-left: 220px;
    padding: 20px;
}

/* TIME CARD */
.time-card {
    display: inline-block;
    padding: 6px 12px;
    font-size: .7rem;
    font-weight: bold;
    color: #fff;
    background: #616d79ff;
    border-radius: 8px;
}

/* PROFILE ICON */
.profile-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
}

/* HAMBURGER ----------------------------------------------*/
.hamburger {
    display: none;
    cursor: pointer;
    font-size: 1.6rem;
    color: #333;
    z-index: 1200;
}

/* BACKDROP */
.backdrop {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100vh;
    background: rgba(0,0,0,0.5);
    opacity: 0;
    visibility: hidden;
    transition: .3s ease;
    z-index: 1000;
}
.backdrop.show {
    opacity: 1;
    visibility: visible;
}

/* MOBILE SIDEBAR SLIDE -----------------------------------*/
@media (max-width: 768px) {

    .hamburger {
        display: block;
        position: fixed;
        top: 15px;
        left: 15px;
    }

    .sidebar {
        transform: translateX(-250px);
        transition: transform .3s ease;
    }

    .sidebar.show {
        transform: translateX(0);
    }

    .main-content {
        margin-left: 0;
        padding-top: 60px;
    }
}

/* DESKTOP ALWAYS VISIBLE */
@media (min-width: 769px) {
    .sidebar { transform: translateX(0); }
    .main-content { margin-left: 220px; }
}
</style>

</head>
<body>

<!-- BACKDROP -->
<div class="backdrop" id="backdrop"></div>

<!-- MOBILE HAMBURGER -->
<span class="hamburger d-md-none" id="hamburger">
  <i class="fa-solid fa-bars"></i>
</span>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">

    <div class="text-center">
        <img src="{{ url_for('static', filename='images/cross-background.jpg') }}" class="sidebar-logo">
    </div>
    <hr>

    <a href="{{ url_for('admin_dashboard') }}"><i class="fa-solid fa-house"></i> Dashboard</a>

    <!-- MEMBERS -->
    <a class="collapsed" data-bs-toggle="collapse" href="#membersDropdown">
        <i class="fa-solid fa-users"></i> Members
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="membersDropdown">
        <a href="{{ url_for('add_members') }}" class="ps-4 d-block">Add Member</a>
        <a href="{{ url_for('view_members') }}" class="ps-4 d-block">View Members</a>
    </div>

    <!-- MINISTRIES -->
    <a class="collapsed" data-bs-toggle="collapse" href="#ministriesDropdown">
        <i class="fa-solid fa-church"></i> Ministries
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="ministriesDropdown">
        <a href="{{ url_for('add_ministry') }}" class="ps-4 d-block">Add Ministry</a>
        <a href="{{ url_for('admin_ministries') }}" class="ps-4 d-block">View Ministries</a>
    </div>

    <!-- LIFE GROUPS -->
    <a class="collapsed" data-bs-toggle="collapse" href="#lifegroupsDropdown">
        <i class="fa-solid fa-people-group"></i> Life Groups
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="lifegroupsDropdown">
        <a href="{{ url_for('admin_lifegroups') }}" class="ps-4 d-block">View Life Groups</a>
    </div>

    <!-- TITHES -->
    <a class="collapsed" data-bs-toggle="collapse" href="#tithesDropdown">
        <i class="fa-solid fa-hand-holding-dollar"></i> Tithes & Expenses
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="tithesDropdown">
        <a href="{{ url_for('add_tithe') }}" class="ps-4 d-block">Add Tithe</a>
        <a href="{{ url_for('view_tithes') }}" class="ps-4 d-block">View Tithes</a>
        <a href="{{ url_for('add_expense') }}" class="ps-4 d-block">Add Expense</a>
        <a href="{{ url_for('view_expenses') }}" class="ps-4 d-block">View Expenses</a>
    </div>

    <!-- EVENTS -->
    <a class="collapsed" data-bs-toggle="collapse" href="#eventsDropdown">
        <i class="fa-solid fa-calendar-days"></i> Events
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="eventsDropdown">
        <a href="{{ url_for('add_event') }}" class="ps-4 d-block">Add Event</a>
        <a href="{{ url_for('view_events') }}" class="ps-4 d-block">View Events</a>
    </div>

    <!-- USERS -->
    <a class="collapsed" data-bs-toggle="collapse" href="#usersDropdown">
        <i class="fa-solid fa-user"></i> Users
        <i class="fa-solid fa-chevron-down float-end"></i>
    </a>
    <div class="collapse" id="usersDropdown">
        <a href="{{ url_for('add_user') }}" class="ps-4 d-block active">Add User</a>
        <a href="{{ url_for('view_users') }}" class="ps-4 d-block">All Users</a>
    </div>

</div>

<!-- MAIN CONTENT -->
<div class="main-content">

    <div id="datetime" class="time-card mb-2"></div>

    <h3>Add User</h3>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <form action="{{ url_for('add_user') }}" method="POST">
        <div class="mb-3">
            <label>Username</label>
            <input type="text" name="username" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Email</label>
            <input type="email" name="email" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Password</label>
            <input type="password" name="password" class="form-control" required>
        </div>
        <div class="mb-3">
            <label>Role</label>
            <select name="role" class="form-select">
                <option value="admin">Admin</option>
                <option value="user" selected>User</option>
            </select>
        </div>
        <button class="btn btn-primary"><i class="fa-solid fa-plus me-2"></i> Add User</button>
        <a href="{{ url_for('view_users') }}" class="btn btn-secondary">Cancel</a>
    </form>

</div>

<!-- PROFILE DROPDOWN -->
<div class="dropdown position-fixed top-0 end-0 p-2">
    <img src="{{ url_for('static', filename='images/iu.jpg') }}" class="profile-icon dropdown-toggle" data-bs-toggle="dropdown">
    <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="/logout">Logout</a></li>
    </ul>
</div>

<!-- JS ----------------------------------------------------->
<script>
document.addEventListener("DOMContentLoaded", () => {

    // TIME
    function updateTime() {
        const now = new Date();
        document.getElementById('datetime').innerText =
            now.toLocaleString('en-US', { month:'numeric', day:'numeric', year:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit' });
    }
    updateTime();
    setInterval(updateTime, 1000);

    // SIDEBAR
    const sidebar = document.getElementById("sidebar");
    const backdrop = document.getElementById("backdrop");
    const hamburger = document.getElementById("hamburger");

    const toggleSidebar = () => {
        sidebar.classList.toggle("show");
        backdrop.classList.toggle("show");
    };

    hamburger.addEventListener("click", toggleSidebar);
    backdrop.addEventListener("click", toggleSidebar);

    // Auto-open collapses if they contain an active link
    document.querySelectorAll(".collapse").forEach(menu => {
        if (menu.querySelector(".active")) menu.classList.add("show");
    });

});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
